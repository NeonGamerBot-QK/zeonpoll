generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-arm64-openssl-3.0.x"]
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Poll {
  id            Int          @id() @default(autoincrement())
  createdOn     DateTime     @default(now()) 
  createdBy     String?      
  title         String       
  anonymous     Boolean      @default(false)
  multipleVotes Boolean      @default(false)
  othersCanAdd  Boolean      @default(false)
  open          Boolean      @default(true)
  timestamp     String?      
  channel       String       
  options       PollOption[]
  votes         Vote[]

  @@map("poll")
}

model PollOption {
  id        Int     @id() @default(autoincrement())
  name      String  
  createdBy String? 
  pollId    Int
  poll      Poll    @relation(fields: [pollId], references: [id])
  votes     Vote[]

  @@map("poll_option")
}

model Token {
  id        Int      @id() @default(autoincrement())
  createdOn DateTime @default(now()) 
  user      String   
  token     String   @unique 

  @@map("token")
}

model Vote {
  id        Int        @id() @default(autoincrement())
  createdOn DateTime   @default(now())
  user      String     
  optionId  Int
  pollId    Int
  option    PollOption @relation(fields: [optionId], references: [id])
  poll      Poll       @relation(fields: [pollId], references: [id])


  @@unique([user, optionId])
  @@map("vote")
}
